<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Store DZ | Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
<script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
<script>
  window.OneSignalDeferred = window.OneSignalDeferred || [];
  OneSignalDeferred.push(async function(OneSignal) {
    await OneSignal.init({
      appId: "d1660843-a5a7-46ed-b5be-2545786b88cd",
    });
    
    // Ø±Ø¨Ø· Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø¨Ø§Ù„Ø¬Ù‡Ø§Ø² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    const user = JSON.parse(localStorage.getItem('marketUser'));
    if (user && user.phone) {
        await OneSignal.login(user.phone);
    }
  });
</script>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #0088cc; --bg: #0b0e14; --card: #1a222d; --text: #ffffff; --success: #10b981; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; min-height: 100vh; }
        
        .page { display: none; padding: 20px; text-align: center; min-height: 100vh; box-sizing: border-box; }
        .active { display: flex !important; flex-direction: column; align-items: center; justify-content: center; }
        #shopPage.active { display: block !important; }

        .auth-box { background: var(--card); padding: 30px; border-radius: 20px; width: 100%; max-width: 350px; border: 1px solid var(--primary); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        input, textarea, select { width: 100%; padding: 12px; margin: 10px 0; border-radius: 10px; border: 1px solid #334155; background: #0b0e14; color: white; box-sizing: border-box; font-family: 'Cairo'; }
        
        header { background: var(--card); display: flex; justify-content: space-between; align-items: center; padding: 15px 25px; border-bottom: 2px solid var(--primary); position: sticky; top: 0; z-index: 10; }
        
        .container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; max-width: 1200px; margin: 30px auto; padding: 0 15px; }
        .card { background: var(--card); padding: 20px; border-radius: 20px; border: 1px solid #2d343f; text-align: center; transition: 0.3s; }
        .card:hover { border-color: var(--primary); transform: translateY(-5px); }
        
        .price-tag { color: var(--success); font-size: 1.4rem; font-weight: bold; display: block; margin: 10px 0; }
        .btn { background: var(--primary); color: white; border: none; padding: 12px; width: 100%; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1rem; transition: 0.2s; }
        .btn:active { transform: scale(0.98); }

        #orderModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:1000; overflow-y: auto; }
        .modal-content { background: var(--card); width: 90%; max-width: 450px; margin: 40px auto; padding: 30px; border-radius: 25px; text-align: right; border: 1px solid var(--primary); }
        .hint { font-size: 0.8rem; color: #94a3b8; margin-top: -5px; margin-bottom: 10px; display: block; }
    </style>
</head>
<body>

    <div id="authPage" class="page">
        <div class="auth-box">
            <h1 style="color: var(--primary); margin-bottom: 10px;">Market Store DZ</h1>
            <p style="margin-bottom: 20px; color: #94a3b8;">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø± Ø´Ø¹ÙŠØ¨ Ø§Ù„Ø±Ù‚Ù…ÙŠ</p>
            <input type="text" id="regName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
            <input type="tel" id="regPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
            <button class="btn" onclick="saveUser()">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ØªØ¬Ø±</button>
        </div>
    </div>

    <div id="shopPage" class="page">
        <header>
            <span id="userDisp" style="color:var(--primary); font-weight: bold;"></span>
            <button onclick="logout()" style="background:none; border:none; color:#ef4444; cursor:pointer; font-weight: bold;">Ø®Ø±ÙˆØ¬</button>
        </header>

        <div class="container">
            <div class="card">
                <h3 style="color: var(--primary);">Gemini AI Plus âœ¨</h3>
                <p>Ø§Ø´ØªØ±Ø§Ùƒ Ø´Ù‡Ø± ÙƒØ§Ù…Ù„ - Ø­Ø³Ø§Ø¨ Ø®Ø§Øµ Ø¨Ø¨ÙŠØ§Ù†Ø§ØªÙƒ</p>
                <span class="price-tag">800 Ø¯Ø¬</span>
                <button class="btn" onclick="openModal('Gemini AI Plus', '800 Ø¯Ø¬')">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
            </div>

            <div class="card">
                <h3 style="color: var(--primary);">eFootball 2026 Coins âš½</h3>
                <label>Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ…ÙŠØ©:</label>
                <select id="efSelect">
                    <option value="1040 Coins - 1500 Ø¯Ø¬">1040 Coins - 1500 Ø¯Ø¬</option>
                    <option value="2130 Coins - 3000 Ø¯Ø¬">2130 Coins - 3000 Ø¯Ø¬</option>
                    <option value="3250 Coins - 4400 Ø¯Ø¬">3250 Coins - 4400 Ø¯Ø¬</option>
                    <option value="5700 Coins - 7500 Ø¯Ø¬">5700 Coins - 7500 Ø¯Ø¬</option>
                </select>
                <button class="btn" onclick="selectAndOpen('efSelect', 'eFootball')">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
            </div>

            <div class="card">
                <h3 style="color: var(--primary);">Free Fire Diamonds ğŸ’</h3>
                <label>Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø±Ø¶:</label>
                <select id="ffSelect">
                    <option value="100 Diamonds - 300 Ø¯Ø¬">100 Diamonds - 300 Ø¯Ø¬</option>
                    <option value="530 Diamonds - 1450 Ø¯Ø¬">530 Diamonds - 1450 Ø¯Ø¬</option>
                    <option value="1080 Diamonds - 2800 Ø¯Ø¬">1080 Diamonds - 2800 Ø¯Ø¬</option>
                    <option value="Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ© - 2850 Ø¯Ø¬">Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ© - 2850 Ø¯Ø¬</option>
                </select>
                <button class="btn" onclick="selectAndOpen('ffSelect', 'Free Fire')">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
            </div>

            <div class="card">
                <h3 style="color: var(--primary);">Netflix Premium ğŸ¬</h3>
                <p>Ø­Ø³Ø§Ø¨ Ø´Ø§Ø´Ø© ÙˆØ§Ø­Ø¯Ø© - Ø´Ù‡Ø± ÙƒØ§Ù…Ù„</p>
                <span class="price-tag">1300 Ø¯Ø¬</span>
                <button class="btn" onclick="openModal('Netflix Premium', '650 Ø¯Ø¬')">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>
    </div>

    <div id="orderModal">
        <div class="modal-content">
            <h3 id="mTitle" style="color:var(--primary); margin-top: 0;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</h3>
            <p id="mPrice" style="color: var(--success); font-weight: bold;"></p>
            
            <label>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</label>
            <textarea id="accInfo" rows="4" placeholder="Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨: Ø£Ø¯Ø®Ù„ Ø§Ù„Ù€ ID.. Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¬ÙŠÙ…ÙŠÙ„ ÙˆØ§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯"></textarea>
            <span class="hint">ØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¯Ù‚Ø© Ù„ØªÙØ§Ø¯ÙŠ Ø§Ù„ØªØ£Ø®ÙŠØ±</span>

            <div style="margin-top: 15px;">
                <label>Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© ÙˆØµÙ„ Ø§Ù„Ø¯ÙØ¹ (Ø¨Ø±ÙŠØ¯ÙŠ Ù…ÙˆØ¨/CCP):</label>
                <input type="file" id="receiptImg" accept="image/*" style="margin-top: 5px;">
            </div>

            <button class="btn" id="sendBtn" onclick="sendToTelegram()" style="margin-top: 20px;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø¨Ø§Ø¦Ø¹ âœ…</button>
            <button class="btn" onclick="document.getElementById('orderModal').style.display='none'" style="background:transparent; color: #94a3b8; margin-top: 10px; border: 1px solid #334155;">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª ÙˆØ§Ù„Ù€ ID Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ (Ù…Ø±Ø¨ÙˆØ·Ø© ÙˆØ¬Ø§Ù‡Ø²Ø©)
        const BOT_TOKEN = '8522676441:AAGvGQztAI9h7my-EBUACjoVtS7nE52xujE';
        const CHAT_ID = '8082796633';

        let currentProduct = "", currentPrice = "";

        window.onload = () => {
            const user = localStorage.getItem('marketUser');
            if (user) {
                showShop(JSON.parse(user).name);
            } else {
                document.getElementById('authPage').classList.add('active');
            }
        };

        function saveUser() {
            const name = document.getElementById('regName').value;
            const phone = document.getElementById('regPhone').value;
            if (!name || !phone) return alert("ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„!");
            localStorage.setItem('marketUser', JSON.stringify({ name, phone }));
            showShop(name);
            // Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± Ø¯Ø§Ø®Ù„ Ø¯Ø§Ù„Ø© saveUser Ø¨Ø¹Ø¯ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ localStorage
OneSignal.push(function() {
    OneSignal.setExternalUserId(phone);
});
            
        }

        function showShop(name) {
            document.getElementById('authPage').classList.remove('active');
            document.getElementById('shopPage').classList.add('active');
            document.getElementById('userDisp').innerText = "Ù…Ø±Ø­Ø¨Ø§Ù‹: " + name;
        }

        function logout() {
            localStorage.removeItem('marketUser');
            location.reload();
        }

        function selectAndOpen(selectId, category) {
            const val = document.getElementById(selectId).value;
            openModal(category + " (" + val + ")", "");
        }

        function openModal(prod, price) {
            currentProduct = prod;
            document.getElementById('mTitle').innerText = prod;
            document.getElementById('mPrice').innerText = price;
            document.getElementById('orderModal').style.display = 'block';
        }

        async function sendToTelegram() {
            const user = JSON.parse(localStorage.getItem('marketUser'));
            const info = document.getElementById('accInfo').value;
            const file = document.getElementById('receiptImg').files[0];

            if (!info || !file) return alert("ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØ±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„ÙˆØµÙ„!");

            const btn = document.getElementById('sendBtn');
            btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";
            btn.disabled = true;

            const message = `ğŸš€ *Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ ÙˆØµÙ„Ùƒ!* \n\nğŸ‘¤ *Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${user.name} \nğŸ“ *Ø§Ù„Ù‡Ø§ØªÙ:* ${user.phone} \n\nğŸ›’ *Ø§Ù„Ù…Ù†ØªØ¬:* \n${currentProduct} \n\nğŸ”‘ *Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:* \n\`${info}\``;

            const fd = new FormData();
            fd.append('chat_id', CHAT_ID);
            fd.append('caption', message);
            fd.append('photo', file);
            fd.append('parse_mode', 'Markdown');

            try {
                const res = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                    method: 'POST',
                    body: fd
                });

                if (res.ok) {
                    alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø§Ù„Ø¨Ø§Ø¦Ø¹ Ù‚Ø±ÙŠØ¨Ø§Ù‹.");
                    document.getElementById('orderModal').style.display = 'none';
                    document.getElementById('accInfo').value = "";
                    document.getElementById('receiptImg').value = "";
                } else {
                    alert("âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŒ ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª Ø£ÙˆÙ„Ø§Ù‹.");
                }
            } catch (e) {
                alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.");
            } finally {
                btn.innerText = "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø¨Ø§Ø¦Ø¹ âœ…";
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
